dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install python-dev
    - sudo python -m pip install -U pip
    - sudo pip install awsebcli
deployment:
  production:
    branch: master
    commands:
      - mkdir .elasticbeanstalk
      - cp resources/circleci/eb/config.yml .elasticbeanstalk/config.yml
      - cp resources/circleci/eb/settings.json etc/
      - python manage.py collectstatic --noinput
      - git add .
      - bash ./resources/circleci/eb/setup.sh
      - eb deploy --staged
test:
  override:
    - echo "test"
machine:
  pre:
    - cd /opt/circleci/.pyenv; git pull
  python:
    version: 3.6.0