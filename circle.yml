deployment:
  production:
    branch: master
    commands:
      - mkdir .elasticbeanstalk
      - cp resources/circleci/eb/config.yml .elasticbeanstalk/config.yml
      - mkdir etc
      - cp resources/circleci/settings.json etc/
      - bash ./resources/circleci/eb/setup.sh
      - eb deploy
      - tox
      - cat etc/qbotio-resources/etc/nltk_eval.json
      - cat etc/qbotio-resources/etc/passthrough_eval.json
      - cat etc/qbotio-resources/etc/compare_eval.json
      - cat etc/qbotio-resources/etc/compare_negative_eval.json
      - cat etc/qbotio-resources/etc/compare_positive_eval.json
      - cat etc/qbotio-resources/etc/filtered_questions.json
test:
  override:
    - bash ./resources/circleci/test.sh
dependencies:
  override:
    - pip install tox tox-pyenv
    - pyenv local 3.6.0
machine:
  pre:
    - cd /opt/circleci/.pyenv; git pull
  python:
    version: 3.4.3